package cz.wrent.advent

import java.math.BigInteger
import kotlin.math.max

fun main() {
    println(dayTwelvePartOne(input))
    println(dayTwelvePartTwo(input))
}

private val cache = mutableMapOf<Int, List<String>>()

fun dayTwelvePartOne(input: String): Long {
    return input.split("\n").mapIndexed { i, v ->
        // println(i)
        // solveLine(v).count()
        solveLineRecursive(v)
    }.sum()
}

fun solveLineRecursive(input: String): Long {
    val split = input.split(" ")
    val signature = split[1].split(",").map { it.toInt() }
    val springs = split[0]

    return processLineWrapper(springs, signature, false).toLong()
}

fun solveLineRecursivePartTwo(input: String): Long {
    val split = input.split(" ")
    val signatureInput = split[1].split(",").map { it.toInt() }
    val springsInput = split[0]

    val springs = springsInput + ("?" + springsInput).repeat(4)
    val signature = signatureInput + signatureInput + signatureInput + signatureInput + signatureInput

    return processLineWrapper(springs, signature, false).toLong()
}

private val recursiveCache = mutableMapOf<Triple<String, List<Int>, Boolean>, Long>()

private fun processLineWrapper(springs: String, signature: List<Int>, inSequence: Boolean): Long {
    val triple = Triple(springs, signature, inSequence)
    if (recursiveCache.contains(triple)) {
        return recursiveCache.getValue(triple)
    }
    val res = processLine(springs, signature, inSequence)
    recursiveCache[triple] = res
    return res
}

private fun processLine(springs: String, signature: List<Int>, inSequence: Boolean): Long {
    return if (springs.isEmpty()) {
        if (signature == listOf(0) || signature.isEmpty()) {
            return 1
        } else {
            return 0
        }
    } else {
        val first = springs.first()
        when (first) {
            '.' -> {
                val nextSignature = signature.nextEmpty(inSequence)
                if (nextSignature == null) {
                    return 0
                }
                processLineWrapper(springs.drop(1), nextSignature, inSequence = false)
            }

            '#' -> {
                val nextSignature = signature.nextSpring()
                if (nextSignature == null) {
                    return 0
                }
                processLineWrapper(springs.drop(1), nextSignature, inSequence = true)
            }

            '?' -> {
                val a = processLineWrapper('#' + springs.drop(1), signature, inSequence)
                val b = processLineWrapper('.' + springs.drop(1), signature, inSequence)
                return a + b
            }

            else -> error("")
        }
    }
}

private fun List<Int>.nextEmpty(inSequence: Boolean): List<Int>? {
    return if (inSequence) {
        val first = this.firstOrNull()
        return if (first == null || first != 0) {
            null
        } else {
            this.drop(1)
        }
    } else {
        this
    }
}

private fun List<Int>.nextSpring(): List<Int>? {
    val first = this.firstOrNull()
    return if (first == null || first == 0) {
        null
    } else {
        listOf(first - 1) + this.drop(1)
    }
}

fun dayTwelvePartTwo(input: String): BigInteger {
    return input.split("\n").mapIndexed { i, v ->
        // println(i)
        // solveLine(v).count()
        solveLineRecursivePartTwo(v)
    }.sumOf { BigInteger.valueOf(it) }
}
//23453188165

fun solveLine(input: String): List<String> {
    val split = input.split(" ")
    val signature = split[1].split(",").map { it.toInt() }
    val springs = split[0]

    val next = mutableSetOf(springs)
    val possibilities = mutableSetOf<String>()
    while (next.isNotEmpty()) {
        val current = next.first()
        val replaced = replaceUnknown(current)
        if (replaced == null) {
            possibilities.add(current)
        } else {
            next.addAll(replaced.filterNotValid(signature))
        }
        next.remove(current)
    }
    return possibilities.filter { isValidSignature(it, signature) }
}

fun solveLineTwo(input: String): Long {
    val split = input.split(" ")

    val list = split[0]
    var nextList = list
    var cnt: Long? = null
    for (i in 0..4) {
        val line = nextList + " " + split[1] + ("," + split[1]).repeat(i)
        val possibilities = solveLine(line)
        nextList = possibilities.random() + ("?" + list)
        cnt = possibilities.size.toLong() * (cnt ?: 1)
    }

    val list2 = split[0] + "?"
    var nextList2 = list2
    var cnt2: Long? = null
    for (i in 0..4) {
        val line = nextList2 + " " + split[1] + ("," + split[1]).repeat(i)
        val possibilities = solveLine(line)
        if (possibilities.isEmpty()) {
            cnt2 = 0
            break
        }
        nextList2 = possibilities.random() + (list2)
        if (i == 3) {
            nextList2 = nextList2.dropLast(1)
        }
        cnt2 = possibilities.size.toLong() * (cnt2 ?: 1)
    }

    return max(cnt!!, cnt2!!)
}

private fun replaceUnknown(input: String): List<String>? {
    val indexOf = input.indexOf("?")
    return if (indexOf != -1) {
        var current = indexOf
        while (current < input.length && input[current] == '?') {
            current++
        }
        val generated = generate(current - indexOf)
        generated.map { input.take(indexOf) + it + input.drop(current) }
    } else {
        null
    }
}

private fun generate(length: Int): List<String> {
    return cache.computeIfAbsent(length) {
        val max = "1".repeat(length).toInt(2)
        (0..max).map { it.toString(2).padStart(length, '0').replace("1", "#").replace("0", ".") }
    }
}

private fun List<String>.filterNotValid(signature: List<Int>): List<String> {
    return this//.filter { isValidSignatureWithJokers(it, signature) }
}

private fun isValidSignature(springs: String, expected: List<Int>): Boolean {
    val actual = springs.split(".").filter { it.isNotBlank() }.map { it.length }
    return actual == expected
}

// private fun isValidSignatureWithJokers(springs: String, expected: List<Int>): Boolean {
//     val actual = springs.split(".").filter { it.isNotBlank() }.map {
//         Part(it.count { it == '#' }, it.count { it == '?' })
//     }
//     if (expected.size < actual.size) {
//         return false
//     }
//     // var filled = actual
//     // while (filled.size != expected.size) {
//     //     filled = filled + 0
//     // }
//     // return filled.zip(expected).all { (act, exp) ->
//     //     if (act > 0) {
//     //         act == exp
//     //     } else {
//     //         // TODO #??.### 1,1,3 this should be valid
//     //         act.absoluteValue <= exp
//     //     }
//     // }
// }

private data class Part(val hash: Int, val joker: Int)

private const val input =
    """#.?#.#???????...??## 1,2,2,1,1,4
???#???.?#?????? 1,2,2,3,2
???????#??.???#? 2,2,4,3
.???????#?? 4,1
?????#????. 1,2,1
#.?#???#???.?#. 1,3,1,1,2
???#?.#.?#??????# 1,2,1,9
.???#????? 4,1
#????#??..????? 1,2
??.#?.???????#??? 2,1,6,3
???.???????.#.#?#?. 1,3,1,1,1,1
???##?????????????## 12,2
???#?????.?#??????.. 9,1,4
?????#?..???????##?? 4,1,1,6
.?#.?.??????.????#. 2,2,5
?##?##.#?##?#????. 5,4,2,1
???..??..????? 2,1,4
?????#?.?##.??##?. 5,3,4
.???.#.#??????.??? 3,1,1,1,1,1
?.???.?#???#??#?# 1,3,1,1,6
.?.??..???#???#????# 1,1,12
..?.?..??? 1,3
???.????????? 3,1,1
.?????.??##??? 3,2
.???????#.### 2,2,1,3
##???.??????#?#?#??? 3,1,1,10
.?##??##??#??? 3,3,1
.????.????????????? 2,1,3,1,1,1
???#??#??.#?? 8,1
???.????.?? 2,1,2
??#?#?.????? 4,1
???????#???#?#?#? 4,9
#.???????. 1,1,3
?#??????.? 1,1,1
?#???##?.???..???? 8,2,1
????????#???.# 9,1,1
???.???#???#?????? 1,1,1,3,4,1
?????##?.??#? 1,5,3
#??##.?.????#???? 1,2,1,6,1
?????#????#???? 1,1,7
????????..??????? 1,2,1,3,1
?##?...???#.?? 4,4
?????#.?.??? 2,3
????.?????#???### 1,1,5,3
#.???#?#?????# 1,3,1,5
.????#?.?????#????? 4,5
.??.???.#?#?#?#.? 2,1,7
.??#?????.?. 5,1
??#??##?.???? 4,2,2
?.?.###?.?#?????##? 1,3,2,5
?#??????#?.??..?# 2,5,2
.????????##?.? 2,4
????##??#???????. 12,2
?.#??.??????#??#?# 1,1,1,9
?#?#??#??#?.???????# 8,1,3,1,1
.?????????.??#? 2,1
??##??.??.? 1,3,1
??.????##???#????# 1,1,7,2,1
????.#???#??##????.? 2,1,9,1
?.??###?.?.??? 4,1
??????#.??????? 6,3,1
??.?????##??. 1,1,6
.#????#??? 1,1,1
??#??.??.?. 4,2,1
?.????????.?.... 1,1
#??..?.#??.?? 3,3
..?#???#?#??#?..#??? 2,8,1,1
???#???.??? 4,1,1
????#?..?.?????? 3,3
??????#????#?.?.?# 12,1,1
#??????????#..? 1,3,1,1,1
???#??#.?#????#? 4,1,2,2
#.?#??#?#???#?.# 1,1,6,1,1
??????.??????. 1,1,2,2
???#???#?. 1,1,1
..??.????#?##??#?? 1,1,9
???.????#?? 1,5
.??.?.???? 1,1,1
??.#????????????#. 1,8,1,2
?#?????????????? 5,1,5
..??.??.#?#?? 1,1,1,3
?????#?????...???? 5,1,1,1,1
.???.??#??# 3,5
???#.????#??????# 3,2,1,1
??????####?.?? 1,8,1
..???#???..??? 4,1,2
????##?#?.#?.?? 2,5,2,1
??##?#???????.??.. 8,1,1
??????????#? 2,1,1
?.?#???#????.???#?? 1,3,1,3,1,3
???????#?? 1,3
???.?#...##???# 1,1,2,1,1
#?.#?#?????. 1,1,1,2
.##.????###?.?.? 2,7,1,1
?#????#???????#???. 9,2
?.#???#??##????? 1,2,6,2
.#?#???.?#??????# 3,1,1,2,3
?#?#??.?..???#?. 4,1,4
?###..?##???#??#. 4,3,1,1
.#??.#????..?..?? 2,1,2,1,2
?..??.??????.?..? 2,3
.?#.??##???????.?? 1,9
???..???????###???. 1,1,8,1
???##??????.? 3,3
???????#??? 1,1,3
??.??????##.??. 1,1,6,2
.##????????????????. 2,5,1,2,1
?#??#????? 1,4,1
#??????.???#???? 4,1,2,1
.##??.??#???#?????? 3,11
.?.??..???.#??? 1,2
...??..??.#????? 2,1
.??#?#?#?#???#?? 9,3
.?#????..##?? 3,3
##??##?????#???#??? 13,2,1
????????????#??# 1,1,6,1,1
?#?##???#??? 1,6
##????#.?#??.#?????? 5,1,2,3,1
??#????#??? 1,4
?.?.?.????##?#?##?? 1,1,1,7,2,1
?????????.??.??. 2,2,1,2,1
??????.????? 4,5
??#?.???#?#??.???? 2,1,6,2
.#.??#...#?.??? 1,1,2
..???.??.?. 1,1
#????.????? 1,1,4
?#.???#??##??? 1,1,3,1
???##???##??#?##.#?? 15,1
?????.#.????? 1,1
???#?#?###??????? 1,8,1,1
?????#????????.#?# 2,7,1,1,1
.????????.#?.#. 3,3,1,1
???##?#?.. 1,6
????#????????#?.??. 6,3
.##?#?.????????? 4,1,2
?#?...????#? 3,4
???.????#? 1,3
???.#??????#??.#??. 3,8,1,1,1
.#???##???? 3,3
??????#?????. 6,1
???.?.?????#? 3,3,1
??##???#????.?#?#?? 4,4,2,1,1
???#??.??.#??#? 3,2,2,1
##?##???????????.? 7,2,1,1,1
.?.??.#????? 1,1,3
?.??????.???#????# 1,1,4,1,2
??#???#?.#?#?##.? 4,2,6,1
..??#..??###?? 2,5
?#????????..?#???#? 3,3,1,3,2
?.???????? 2,2
#?????#?###??? 1,9
??.???##?.???????#?? 1,1,2,10
?#?#.????#?.?#??? 4,5,5
???.????????..? 1,5
???#?????.?#.???##?. 2,6,1,5
.????????###??????? 2,1,6,1
??#?.?#?.???? 3,2,1
.????#????.# 1,1,5,1
??????##?.?..??? 2,3
.?#??????. 2,1
?.?.???????.???????? 1,1,1,4,6,1
??.??.#??##??#???? 1,11
????????##?#??? 12,1
?#??#?#.????#?#???# 6,9
?#???.#?.. 3,1
??#?.?#?????. 4,2,4
.??.?..??#??? 1,4
???#..??.?#??????? 1,1,1,4,3
?###???.?#???? 6,5
?.#?????????.?# 1,2,3,2,2
.?#?.#????##.?. 1,7
?.?#..???????? 1,1,2,2
?????.??#?.?#??..? 1,3,4,1
#??..??????????##? 1,1,1,1,3,5
?????.??#??##???? 2,1,6
..?.?#??###????. 2,4,1,1
##??.#????#?#???.. 4,6,2,1
??#?#??#.#???#??? 4,2,1,6
.#?#????#..?#??#. 8,4
???..???#?..#??? 2,5,1,1
?##?.?.???##?????.?# 2,1,1,7,1
??????#.?.?#???#.? 1,3,1,6
?????????#????#? 3,5,2
?.##?##???#? 5,3
???#?#??#?#?# 1,10
?##??#???? 3,1,3
??#??#????.??.?##. 1,3,2,1,2
???????##????? 1,5,1
??##????#.???# 9,3
?.??????#??.?.????. 9,2
??.??????#???? 7,2
??#?.??.#.??? 4,1,1,2
??.#??#??.?? 6,1
#??????????? 1,1,2,1
?##???##?.?##???? 8,5
?.?#?#??.?#??#?.? 3,4
.#?.????#??#?##.. 2,1,7
?#?.#?##.? 1,4,1
?????##?##??? 7,2,1
??.?.?##???? 2,7
???.????#???. 1,6
?#?????.??. 5,2
????#??.#?#. 1,2,1,1
.???.????#?#?.?? 3,6,2
???.??.?.?.? 1,1,1,1
?#.#????#??#??? 1,7,1
.???#?????#??.?? 1,2,2,1,1
..??.???##..? 1,5,1
.???????..? 2,2
?#????????????#? 2,2,4,1
????..??##?...#????? 1,1,4,1,1,2
?#.???#?????????? 2,4,4
?#??..??.#? 2,1,1
?.?#??????.??#?..?# 1,7,1,1,1
#??#..???? 2,1,1
??#?.??#?.???? 2,2,3
.#???..??? 1,2,1
.??.?#?##.#???.?#? 1,5,3,1
?????.?#?#??????#?? 1,1,7,1,1
??#??????.?#??#?#? 1,5,8
??.?.?.???????? 1,8
?#?#???#?????# 1,9,1
.??#.#??.?#???##?# 2,1,1,1,4
???#???.??#?#? 6,1,1
?###???.?#.?..? 4,2
?#???.????.??#.???. 5,2,1,1,1,1
??????..??.?.##.? 1,2
?.#?#??????...????? 9,1
..??.?.#?? 1,1,2
??##???????????.##? 9,1,1,2
.???.?????? 2,1,1
??#.#?.?#?????.?.? 1,1,1,1,3,1
???#????#????.#. 1,1,7,1
?????#?#?.?.. 6,1
???.???????#??#????. 1,12,1
??.??.?#??# 2,5
?.????#?#????. 1,4,1
???##????#??? 4,3
???????##. 1,1,3
.?.##???#?.?#????? 1,3,2,5
?.??.##??.? 1,2,2
???????#?#???? 3,1,7
#?#.??????#?#??.?.?. 3,2,8,1
.??.??.???? 1,2
???????..?#??? 4,1
?.????##?? 1,5
????#??#??.?#. 7,2
?.##????##?????#???? 2,5,5
.??#.???...##?? 1,1,1,1,2
#??????##???? 1,1,3,3
?###??????????????? 6,11
?#?.#????#??.? 3,2,2
.????#?????#?? 10,1
?????#???? 1,1,5
?#?????.?????#??#.. 1,1,1,1,1,4
????#??.?# 1,5,1
???#?????? 4,1,1
?#?..?.?.?? 2,1,1
#??.??#??#?##??#???? 1,4,1,5,3
?..?#?#??.#???? 4,1,2
?????#???#??#.?#??? 13,1,2
?..#??.??? 2,1,1
???#????#?.????#? 8,2
.???#.???##?????? 1,2,1,9
#..#?#???## 1,5,2
??..?#.??? 1,1,1
??????#?.??.???#. 1,3,1,4
.?##.?..???##?. 3,1,4
?#????#?#?????.? 9,4
??##?.?#??##??. 5,7
??#????####??..#???? 11,4
..#??????? 3,2
?.????????##????.?#? 11,1
.?##????#???. 4,1,4
#???.???????#. 2,1,1,5
#??????#??.?? 1,1,5,1
???????##???#?#.?#? 1,1,5,3,2
?##????##??##? 2,2,2,2
?##?#????..????#?? 5,3,7
.????.#???#? 1,1,2,1
??##???#.?.?#.#?? 7,1,1,3
??.#??#.?#?????.#? 1,1,1,6,1
???????.?#????? 3,1,5
??.?#?.?#?? 2,3
?##??????.?##?? 5,1,4
???.#???#?????#???. 2,12,1
???#??##???#??# 1,6,3,1
??.??.#??####??#?#? 1,2,2,10
??????.?.??????. 2,5
...???.??##?... 1,3
????#..#??#?#?#??### 1,1,13
????????.???.?#.? 4,1,2,1,1
??##??????#????? 7,4,1
???????#?#?#?????#.? 1,1,4,4,1
..?#???#????? 4,4
?#??.##???.#?? 2,5,1,1
.??????#??.#?.?. 1,1,3,2,1
#???.??????????? 1,1,1,9
??.??.?#?.? 1,1,3
#??????#??? 3,4
??#??.??.???#.??# 4,2,4,3
??#???????..?.???### 4,1,1,1,1,4
?.?????#??#?????.. 7,1
?????..?.# 1,2,1
.???###???????###??? 10,6
?#??.?????? 3,1
.#.??#??????? 1,2,1,1
.??#??????#? 1,8
?.?#??..?????? 4,4
?#?#.#.?.?#????? 4,1,1,1,4
?#.?.?###????? 1,1,6,1
.?#?##?###??.?..? 9,1,1
..??????#??????#??? 7,3,2
???#???#?????.. 7,1
??##????.??#??. 5,1
???#????.#?#????? 1,1,1,1,5
????#?????.? 1,5,1
?????#?????????#?..# 4,5,6,1
?????#?#???.?..???? 6,1,1,1,1
?.???#?#?.#?.?.? 1,5,1,1,1
?##????.?.?##?? 3,4
.#?..????. 2,1
??#.##??.. 1,3
?####?#####?????? 11,1
.??.#?..??#.???? 2,3,3
???..????#?#?. 1,3,3
????????#??? 1,2,4
##???.??.#?#????##?# 2,1,11
??.?##??.?..?#??. 3,3
??.#.#.??.????? 2,1,1,1,2
?????..?#???? 4,3
??????#?#??###??? 2,4,5
??#??#?#.?? 8,1
??#?????#? 6,1
??.##?#?#?#???# 8,1
#?#?##???#??#?#????? 1,5,2,1,1,1
.?.#?#?#..??. 5,2
??##?###????? 7,1
?.#???????##????? 1,1,4,2
.??.??.?.?#?????# 1,1,3,2,1
.#???????.??#?? 2,1,4
????##?????.#?? 8,1
????????.#.. 5,1
?????#?#???? 6,1
..?..???????..?#?# 6,3
??.?????#?#? 1,4,1,1
.?????#..???? 2,2,1,1
.#??????#???##??? 1,1,7,1
??.?##??#.????..? 5,1
?.??#.????? 1,1
???.?.?????#??#???# 1,1,1,1,8,1
.?#??.##.##??#??#??? 2,1,2,6,3
?.???#??????.? 4,1,2
?.?????#.?? 3,1
#???##?.?. 6,1
????.???##?#???????? 1,1,4,3,2
.??.?#?.## 2,1,2
???.??????????.?? 1,10,1
.???.?????? 1,1,2
??..???????#?..?#?#? 2,4,3,5
#?##?.????? 4,3,1
???#??#?#????#??#??? 7,7
??#.??##????. 2,4,1
??#??????????.#?? 1,6,1,1
????##?????.?#???? 7,1,4
?.??????????#.???? 9,2
???????##.????#.? 6,5
????#??.??????#???? 3,2,1,5
.???#?????#.?..???. 9,1
#..??.??##. 1,2,4
???????#?#..? 2,1,1,1
?????????.????? 2,5,1
???#?#???.? 1,6
?#???##?#?. 2,6
?..??#???? 1,1,1
?????#?.#.? 2,1,1
.#.????#??#?##?? 1,1,11
?.??.#??#????#. 1,1,1,6
?...##.????#.? 2,2
?????.???#??.#. 1,1,6,1
?#???#????###?#. 1,1,1,8
??#??.?.?. 2,1
#??????????.????##? 1,1,3,1,6
?.?.?????#??????#??? 1,1,9,1
???#??.????????##?## 1,4,4,1,5
.#???????. 3,2
???#.????.?.####?# 1,1,3,6
....??????#???? 3,6
.??????#??????.? 5,3
?.????.?## 2,2
?#????#?..?#? 7,1
.?#??????.??? 6,1
?.?#????????#??. 2,3
?..????#???.?#?? 3,1
##???#???.?.?.? 2,3,1,1,1
?.??#?.?#?#?####?.?. 2,9
.??..##?????. 1,3,3
.?#???##?#??.??..? 4,6,1
?.?#?..??#?#??. 3,6
???#?????##?.??#?#? 3,2,2,6
?#????#?.?#.#? 3,3,1,1
???#??????????????? 1,4,3,6
.##?#?.?#????##?? 2,2,7,1
?????#????.??.?.#??? 8,1,2,1,1,1
#.?.?????#?..????.? 1,1,7,2,1,1
..##?.#?.??#?.# 2,1,1,2,1
??#??...?#???##. 4,2,3
#?#?#????????????? 7,3,1,2
..#??#?##. 4,2
##?####.#??.??.?? 7,1,1,1,1
??#.???##??#.#?#? 2,8,4
?#????#..?.????#?# 2,3,2,4
?.?.#.?????#?#???. 1,1,1,2,1,6
?#???##?#.##???????. 8,6,2
????.??..??##?#? 1,2,1,5
???#??.#?#????? 1,1,1,1,5
????###?#?????? 1,12
???????##????#?##? 1,2,8,3
#.???.?.?#??????. 1,1,1,1,7
?.?#....????. 1,4
??.#???.?#? 1,2,1
?.?.?#???? 1,5
????#?.???#?? 5,1,3
??#?#??#.?.?? 8,1
??#.?#??#.??.?? 1,2,1,1,1
???#???..??#?? 1,1,3
??.#??????? 1,3
?.?#?#?#???????#? 1,8,1,3
?.?####??.?.?.? 5,1
?#???#?.???.?##? 2,3,1,2
.#??????#??..? 3,4
????##?.????#???#? 1,3,1,1,5
???????#????#????#?. 1,2,2,3,1,1
??#..?????#???? 1,2,3
????#?.??? 1,1
??.?#??#???.????? 1,5,2,2,1
..??????#.???# 5,1,1
?#?#?##.????. 6,2
?##.?????.??... 2,4
.????.#?...?##.# 1,1,2,3,1
.????#?#??# 2,7
?#?#.##??#?#??.?#??# 1,1,7,1,2,1
????#?????? 1,3
????##?#?..#?#?#??? 7,5
.?.???.??.?? 1,1,1,1
???.???#??.???#???# 3,4,3,3
.??##???#??#???#??.? 12,2,1
????#?#?#???#.#???.# 1,7,1,1,1,1
.?#?###??#??.?#?? 7,1,1,4
.#????.?#?#. 1,1,3
?#?????.?? 2,2
??.???#.?????? 1,2,1,3
?#.??##???#?.. 1,2,1,2
??.??.???#??? 2,4
???.????.?..?? 2,1,1,2
?#??#####???#.?????? 3,9,2
??.??.??#???#? 1,1,3,4
??#.?.??#???#??. 2,1,2,1,1
?.?????#?? 1,7
?.###????.??. 6,1
.??#??????#?##?? 8,1,4
???##?#???.??.? 6,1
.??..####? 1,4
??????.??????# 2,2,1,1
?.#???#.??#?? 5,3
?...#?#?.???#??.?# 1,1,1,3,1,1
#???.????? 1,1,2
??#..??#?? 3,3
#????.????#?#..?#. 2,1,1,5,1
.#?#??????????????? 1,1,7,1,1,1
??#?????#??.??.?## 11,1,3
#??#????#????? 9,1,1
?????##?????#? 2,8
???????????.???###? 9,1,3
??#?.?.???.#.?. 3,2,1,1
?.??#?#?????.???? 1,4,1,1,4
.##??????? 3,1,1
?????#???#????? 1,1,4,1
.??#?????..#????? 6,6
#??#??#????????# 13,1
??###?????#??????# 9,1,3,1
##???.???#?#?????# 2,2,1,5,1,1
.??...???#? 1,4
?.????.???.???#?#? 2,1,2,3,1
??#?#????? 1,1,2
???#??????????? 3,6
??#?.?#?#. 2,4
.?#????????.??? 3,4,2
????#.???????? 3,8
.??.???#?#???. 2,4
?.??#????#.#.??# 1,8,1,2
..???.?#??. 1,1,1
?????#..?#???# 6,2,1
?###???.#.???#?.??.? 6,1,2,2,1,1
?.??##??##???? 1,3,6
????#.??#??#??#??? 3,2,1,4
#?##?????.##????#? 5,2,7
????#??##?..??? 1,2,3,1
???????#????#?? 1,3,2,1
##??#???????..??#. 8,1,1,1
.##?#?##?#??#?#?#? 12,1,1
??????##?.????? 9,2
????????.. 3,1
?.?#??..?#???.# 1,1,1,5,1
.#???..?#.?#???? 1,1,1,2,2
#.#?#?#?#.#??.???? 1,7,2,1,1
????#??.?#?#??????#? 1,2,1,11
?.#???.??.?#????## 1,2,2,1,5
?#???.??.#?#? 4,2,1,2
????.?.????#??.?? 3,7
?????.#???.# 1,1,1,1
#?.?.???#?##??? 1,1,2,5,1
.?.??#.?#?..?#?????? 1,1,1,2,4,1
??????#.??????? 4,1,1,2
???##??###? 3,4
????.#?????#???#.# 2,2,1,1,1,1
?????.???#??#???? 4,7,2
#.??#?????#?. 1,5,3
?##????.??. 3,2,1
????..??##? 1,1,4
?.#??.?#??.??????#? 1,3,2,1,4
????.?#???. 2,2
#.???#?.?#?? 1,1,1,2
??##?.?#???##??.## 4,7,1,2
?.?????.?#? 2,1,2
????????### 2,6
#?.?????#?# 1,6,1
??#?#??.??????.??.. 3,1,1,4,1,1
?#?.??.#?? 1,2,2
.??????#.#??.#????# 7,1,3,2
??##???###?#??????? 5,8,2
?#.??#?????#??#?? 1,6,1,2,1
?.##??#?#???. 1,2,3,1
#???#????#?#????? 6,1,4,1
?.?#..?????????# 1,1,5,1
???#???.#??? 4,1,1,1
?#??#?##.??? 4,2,1
?####????#? 6,3
?????##??#?##??#???? 1,11,3
?????????????#??#??? 1,1,1,1,1,7
???????.??##.?#?? 3,1,3,3
???#?.????? 3,1
??.#??????#???.?#.? 1,1,1,5,2
?#???#??.. 1,1,3
??#?#???????? 5,1,1,1
?#.???#??#???#?#??? 2,3,9
????##?????.?#???# 1,2,1,2,6
?.????#???????.?? 1,8,1
.??????#?#?? 1,9
.?##..???#??.?# 2,1,1,1,2
.#?#?????#????????#. 1,1,1,2,7
??#??????#?#? 3,1,3
?????.???..???? 1,1,2,1,2
.???.???.#?#? 1,1,1
????#.??#?#?.?##??? 3,2,2,4,1
.????????.#?#??#? 1,1,1,4,1
?.#??##???????? 1,2,2,2,2
.?????#?????##? 3,1,2,2
???#??????.?? 1,3,3,1
.???#?####?#??.?# 1,11,2
#?#..????#?. 1,1,1,2
.???????#??#??? 3,5
?.?.???#?.?#??. 1,1,1,3,3
?.??#?#####?.#???.? 8,4
??.???#?.#??#????#?# 5,5,3
.??????..??? 1,1,3
#????##??????? 3,3,2,1
#?.?##??##????. 1,9
??#??#.????#?.?#?## 3,1,2,3,5
.???#?????.?? 3,1
..????????#???.. 8,1
?????#?.???# 4,2
?.?.????#??.???##? 1,1,2,1,1,4
??#?#..?#???#?#??.?? 4,8,1
?#??.??.?#? 3,1,2
?.?...##???? 1,5
??#?.??????? 2,5
???.??##?#?#??? 1,1,7,1
.??.???????#???? 1,9
??##?.????.?#???#?? 5,3,1,4
#?????#?.?? 2,3,2
??#??#???##??????.? 4,11
???????##????. 1,11
?#??..?#??#??? 2,6
????????#?#????#???? 1,1,8,1,1,1
?..?.#??.???#?? 1,2,2,1
???#?.???#? 4,2
?.??.#?.??? 1,2
???.?????#? 2,3,1
?..#??#???#?#.? 1,1,1,5
?#?#?#??????#.?#???? 13,3
????#?.??????? 2,6
???..#???.????#? 2,4,4
?????#.??#?#??#?##? 1,1,1,6,3
.???????????? 2,5
.??.??.?????.??#?#? 2,1,1,2,3
.?#?#??????.###?#.? 5,2,1,5,1
??.??##???#?.?.????. 7,1
.#??.?#???#?#?????.. 3,12
?..??..#?.?.?? 2,2
???????.?#????. 1,5,2,1
##?.?#.???????#??#? 3,1,1,2,2,1
?.??#?.?????????. 4,1,1,1,2
????.??##? 3,4
?..??.?#???#?#???#.? 1,11
???#??#?????????. 1,4,4,1
#????#?.??#. 1,3,1,1
.???..??????.? 2,1,2
.??????????#?##?.?? 1,7
#.?.#.????#?.#? 1,1,4,2
???#?.?.??#. 4,1,1
?.??#??.?.?.#????# 3,1,1,1,4
??????#?#.?# 2,4,1,1
?.?????##?.??.??? 1,1,4,1,1
?##????.?.#?# 5,1,1,1
..??#??#??. 1,3
??????#?#???..??. 9,1,1
?.#.#?##?##?#???# 1,1,1,7,1
??.?#????? 1,1,4
?.?.??#?#.??#????. 1,5,5,1
???.?#?#??? 1,1,1
??#??????? 1,2,2
..????.??#.? 1,3
???.??..??#?##??.?.? 2,7,1
?#?.???.????.?? 1,3,1,2
#?????#.???# 5,1,1,1
??.??.???#???##??? 2,7
?.?.#?#??.???..? 1,1,3,1,1
.#?.???..###??????#? 2,1,5,5
??.??????????.???? 8,2
??????????? 4,1
??#??#???.#. 3,2,1,1
???#????##?.?#?#? 4,4,4
??#????#?????.. 2,8
?.???.##?????? 1,1,6
??#.?##???#?. 2,2,4
???#?#?????????? 6,1,2
?.????##?###?##? 9,3
?????????? 1,4,1
.??#?????? 4,1
.??##..?#?#? 2,4
?????#??#??#?.#.? 1,8,1
.??.?##?#?#? 1,7
????????#??. 2,6
??#.?.#???.?? 2,4
?##?##???##? 7,3
?#????????#? 3,3,2
?.?????##?? 1,4
.????????.??? 5,3
##.????#??? 2,3,1
?#?.?..??. 3,1,2
????????#????##??### 1,3,3,9
??????#????#????? 2,4,1,6
???.???.#.???#?##? 2,1,1,1,5
???###?.#?????##.. 6,8
???#???#?##.??#?. 3,6,1
?#???...?.??###.??.# 4,1,4,1,1
??????#??#? 1,2,2
??????.??.??. 1,2,2,1
?.?.#????? 1,1,1
.??????.#??? 1,1,1,1
?.?#??#??.????#??.?# 2,2,1,3,3,2
??????.?.#?#???.? 4,1,1,2,1
?????#.###.? 1,2,3,1
???##??#??#???????? 12,4
?#?????????? 3,1,1
?.??#??.????#? 5,1,3
.???##???? 1,2,1
?.???????? 4,1
.#?.?.???? 1,3
??#.??????# 3,3,1
??.?##?.?.??#?? 1,2,1,1,2
.????#??.##??.?#. 2,4,2,1,1
?????.#??. 2,1,1
?#?????#.? 2,1,3
?.?????#?? 1,5
??????#?#..?? 1,1,1,2
?????.????###? 1,2,1,5
.???#?#??? 4,1
.?.?###????? 1,5,1
??????????..?###? 6,1,3
????#?#?#?????###??? 2,3,3,8
??#?..#???? 1,3
???#???.??.?? 4,1,1
??#..???#???#??? 1,1,5,4
??..???##?.??#..? 1,4,1,1,1
#??#.?#????? 1,1,4,1
.??.?##????# 4,2
??#??#????.???# 1,1,1,1,2
?#.????.?.????#??.?# 2,3,1,2,3,1
##???..?.?.????? 5,1,2,1
???.?????????????#?? 1,15
??##???.??#??? 1,5,2,1
.?.??????#?? 2,3
?.#???#??? 1,2
.??.??..???# 2,2,2,1
????#?#??? 1,4
??#??#???? 1,3
??#..??#??????? 1,1,1,8
??????.????#???#.? 1,2,1,6,1
.???##???? 1,2,1
.?????.?#..?. 4,1
#?.???####?#?.???? 1,1,8,1,2
.?.?#..??#??.? 1,3
?????#????????#??. 1,6
#???#??.??# 1,3,3
?????????? 7,1
??.???.??? 1,1,1
??????#??.???????.#? 1,2,1,5,1,1
?#??????????????#?. 5,2,7
#???.?.??.?..#? 3,1,1,1,1
.????????????.???.# 1,9,1,1,1
?#?#??????#???## 6,7
..??#.???#.#.????#? 3,3,1,5
?????###?????##???. 16,1
????????#??????#??# 1,1,7,5
.#?????#???####??#? 2,4,8
?#.????###?#?. 1,1,1,6
?.??????###??#?? 1,1,6,4
.?..??.??.???#?.##? 1,1,1,5,3
?????.?#??#??##? 1,2,1,1,3
?#??.?.#?? 3,3
.?????#??.?.# 1,5,1,1
.???????.??#?##?#?#? 1,5,1,9
????#?#??#. 5,1,1
?#????.##?##?..?# 5,6,2
.?????.??#????#???# 1,3,5,2,1
?##????.#??????#? 6,1,1,1
??##?.????##??#?#?? 5,4,4
.???###??...?????? 1,4,1,1,1,2
???#?..???. 3,2
.?.?.#???##???.. 1,2,6
????#?#?#?????. 10,1
.???#??.??.??? 2,1,2
?..#?.?#?????.?? 1,2,1,3,1
??????.??#?#?#. 1,1,3,3
??#??.?##?????##??? 2,3,4
?#?.#.???? 2,1,1
.?.?#?#?####.?.#?# 1,3,4,1,1,1
??.#?..?#?????? 1,1,3,1
#??#??#??.?# 2,6,1
?#??#???????#??#??? 5,6,2
?..#??#?#####.?#???? 1,10,1,1,1
??.????#???#?##?? 1,9
????.?#.?# 1,1,1
???????????? 6,1,2
#..????#?#?#??##.??. 1,3,1,1,5,2
??#?.????###???? 1,1,1,6,1
????.????#?.?# 2,1,1,1
???##????.?.???.??. 1,2,2,2,2
?????.#?#.???.??? 2,1,1,1,2
???#??????.?? 4,1,2
?#?#?????#?#..??#. 11,2
.?#?##?????###???.#? 6,7,1
#?.##?????# 1,8
#..#????????? 1,3,1,2
????#??#??? 2,2
.?##?.?..?.???.?# 4,1,1,1,1
?.????.?#?.???? 2,1,2,2
??#??#?.?. 6,1
?#??#??#??##..?## 3,1,6,3
??#.???##? 2,4
#??#????.?????..?.? 1,5,2,1,1
.?#??#??#????#?#?? 2,2,10
####????#??##.?????? 5,1,3,4
???##.?.??.? 1,2,1,1
.?#?????##?????##?. 8,4
.?#????###??#??#???? 2,11
???###?#???#????# 9,1,4
??.??.?.?#???. 1,1,4
#???#??#?#?#???##? 1,3,1,1,1,2
#????##?.? 1,6
##?.?#?#??#?? 3,7
??##????#?.?.?#?#??? 1,2,5,1,1,4
.?#?#?..#?.... 4,1
##?#?#??????. 2,4,1,1
?????????#?????? 1,3,1
?.??#??????? 3,1
###?????#?#??#.#??. 3,2,4,1,1,1
.#???.??###? 1,1,5
?###???.?????. 5,2
?##???????????.? 3,1,5
??#??#?####??.?? 9,1,1
##??#..??????.??#??? 3,1,1,4,2
.???.???...?????? 1,1,5
.?????#????# 3,2,2
.####?.???? 4,1,1
?#.?#??#??##?????? 2,12
.????#?.???? 2,1,2
??#????#??#?? 3,5
?????#???#.?..??#??# 9,2,2
??????.?#? 1,1,3
?#?.#?????. 2,1,1
?#??.???.? 2,1
???????#?.. 6,2
#?????#?#??..# 10,1
?????????. 1,2
...??.##?????#??.?? 8,1
#??????#??##???.? 2,4,6,1
?.##????#??#.?#???# 3,1,1,2,2,1
???#??.???? 1,2,1
#..??#??#??.?????.? 1,4,2,3,1
?#?#.??###??##? 4,9
.???#.??.? 4,2
?..?.?#.????#.?? 2,2
.???##??#???###.?.?? 6,7,1
??##???#?.?? 4,1
??##?#????#?????#.? 13,1
???#?.#?##?.#?#? 3,5,1,1
??.???#????. 1,5,1
.??#???.???. 5,2
??????.#??#.??? 5,4
??#????#?##???.?#??? 12,3
#????????? 1,1,2
???????????#?.. 1,1,1,1,2
??#??#?##????#???#?? 1,2,9,2
?????..??????.??#.?. 3,3,3
??.?#?#?????##?.#?.? 4,6,1,1
??#????##.???? 8,2
?#?.??.#?#?##????? 2,1,9,1
???#???#?..??.?.. 7,2
#.??#??#???.????.?#? 1,9,1,1,2
????##?.?.??.?????## 7,1,2,1,1,2
.?#?#???#???#.?.. 6,1,1,1,1
??.?#??#????.? 1,3,5,1
?#?.??#??? 2,3,1
???#?##???????? 6,1,1
?#?.?????#?????#?. 2,5,5
#?#?#??#???.???? 6,1,1,2
?.??#????#?.??###?. 8,5
.##??#??#???.? 2,2,1,1
???##?.??? 1,3,1
?##.?.????#.#..?# 2,1,3,1,1
?#?#?...?#?#????.??? 4,3,2,3
..##??..????#?????? 2,9
?#??.?#?#?????#???. 3,5,4
???#?????.#???#??? 1,1,1,1,5,2
????.??.#?#??# 2,1,3,1
?#??#????#???.#? 12,1
??????????#??????.?# 1,7,1,2,2
??.????#?##????#? 1,2,1,4,2
??###????? 1,3,1
?#?#???#???.??# 3,1,1,1,2
???#????????. 6,1
##..????.? 2,3
?##????... 3,3
.?.?.?.#?? 1,3
.?.???????????????? 8,7
??#?###?.??..?? 7,1,1
?????.?#?#? 2,3
??#.??#???????#????. 1,7,1,3,1
?????.??#?? 1,1,4
.?????##??# 3,4,1
..??.??#??. 1,1
??????????.#??#?#? 6,7
##???????? 4,4
?????##.?#??. 5,2
#?.?????#??? 2,2,1,1
??#??...??? 4,1
???#??.???#? 1,2,4
??#?????.#? 1,5,1
????.??##?? 2,1,3
?????.??.?.? 3,2,1
.#??.???.?.??#??#?? 2,2,1,2,1,1
#????.??..??#?.#?## 5,1,1,2,4
???????##.????.?#? 7,1,2,2
.???.???????#??????? 1,2,1,5,2
.?#????.??? 1,1,2
.#?#?#?#??#???#..??? 1,10,1,1
??.????#?.????????#? 1,3,2,1,8
?????##??#??.????.. 5,2
..?#???#?##?#??? 2,2,5
??#.?#.??????#? 2,2,1,1,2
.???.????#????? 1,8
??##?###??????#???? 8,3,2,2
???..#.??#? 2,1,2
?#???#???.?# 7,1,1
.#?.???#???#? 1,7
???.??#???..??.? 3,2
..?.#????????. 1,1,1,3
????#??#???#??????? 9,1
.?#????.?...?. 5,1
#??.?????.???#??#?? 3,4,5,1,1
????###??#? 5,1
#???##?#??.?.?????? 10,1,2
?????#?##??.?...##?? 1,6,4
???????#???.?##??. 4,4
#.??#?#.#??.??# 1,2,1,2,3
?????.??????? 2,1,1,1
?????#.##??#?#? 1,3,7
.??????#?#???.??.?. 12,2
??#????.####??#??.?? 3,1,4,3,1
?#.#?????#.?#? 1,7,2
?.?????.?????? 3,4
??????#?.????#???? 2,1,1,1,6
???.#???#? 1,1,2
????#???#??. 6,3
#?##????.?? 6,1,1
?.???##?##.??? 7,1
????.????#.? 2,5
.?#???#???# 1,3,3
##????..#??###???.?? 6,2,4,1,1
?????#?..?#???#?? 2,2,8
??#?##??..?#????#??? 5,3,2,2
???#?????#?.???? 1,7,2
.?.???#????.??#???? 5,1,1,1,2
#????????#?.?#?? 11,1
???#??#??? 1,5
?#??#??????#? 2,1,4
????.#??#.??? 1,1,1
.?????????? 7,1
.??#?#???.??. 1,5,1
#???#?????.#..?..? 1,1,6,1,1,1
?..??.???#???? 2,5,1
???????..??##???.. 3,7
#????.????? 5,1,2
.??#????#???? 1,3
?##????##?. 3,1,3
.?..??#??? 2,1
??#?#????.?# 4,3,1
?##?..????#??#??#? 2,6,1,2
??#??#?###???##?#.#? 1,1,12,1
??##??.#?#??#?.? 1,4,7
??##?#??#??? 6,2,1
????.???.?#?#?##? 2,2,6
#????.????.# 4,1,1,1
#?????#?.???? 1,1,1,3
?#???.##?##?#?#?.?# 3,2,2,4,2
..#?#??#?????#?? 4,9
??#?.??#?. 3,3
.??.????????# 1,2,1,2
?.????..?????????? 1,2,6,1
??#??.????#??.????#? 5,3,3,1,2
.#?.????.????#?? 2,1,2,5
#?.##????#? 2,3,2
..#?.#?##???.?#?#? 2,4,1,4
????????????#??.?#? 4,1,5,1,1
#?#????#..#????##??? 1,1,2,1,6
?#???#?#?????? 2,8,1
?#???.?#?? 2,1,4
?#???.???#?# 1,2,6
?#?##?.??# 5,2
?#???.???????? 3,1,7
?.???????????#?????? 1,3,1,4,1,2
..???????.??? 1,1
#?????#??#.?.#.??..? 10,1,1,2,1
?.?#??????? 4,2
.???#????##?????? 10,2
?#??????##. 1,1,2
###???????#..??#.?? 11,3,1
.???#??.?#??? 2,1,2
.?.?###?##? 1,3,2
#.#?#??####?#?????. 1,1,10,1
.??.????#?#? 1,5
#???????#.??? 3,1,1,1
#..????#??#?#?##. 1,13
?.???.?#?.???#.???? 1,2,2,2,1,3
?..????????. 1,2,3
?.????.?....#????? 2,1,1,6
?##?..??#. 3,3
???.#???..??#.. 2,1,1,3
.?#??.????? 2,1
??????.???. 1,1,1
???#.????#???????. 1,1,8,1
???##???.??#??? 3,1,1,2
????#?..??? 1,2
???#.#??#???##?.??? 1,1,1,7,1
?.????#.?????? 1,5,3,1
????????.??#??#.??.? 1,6,3,1,1,1
..???.?..?#?? 2,1,1,1
???.??..????###?#? 1,1,1,7
??.????.????###? 2,6
????#??#?.?# 1,4,2
.#.##?.?????. 1,2,2
?.????????? 2,2,1
?#???#???.??? 2,1,2,2
???????##? 1,6
#.?????#.#????# 1,4,6
??.##?#?????.#?????? 2,9,1,2,1
##.?..?####?##?? 2,8
???#?.???#??#????? 3,10
?#?????????.?#?????? 10,4,2
.???.????#????? 1,3
#??.?????? 3,2
.??????.?#?#?? 1,1,6
?????????#.# 1,1,1,1
??#.?#???????#.????? 2,6,2,5
??.?#?##??#?#?##??? 13,1
.?.?#???##? 1,1,3
#??????.##. 1,2,2
?##??#????? 6,1
?#????#??#.??.# 6,1,1,1
##...???.?. 2,1
?###???#.#?#?..?.?? 8,3,1
??#?.???##???????#. 1,1,1,4,1,1
#####?.????#???# 5,1,1,3
#???###??..?#? 2,6,2
?.???#??.#?? 4,1,2
????#?#?????????# 1,9,1,1
?##??????#? 3,2,2"""
